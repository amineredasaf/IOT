# -*- mode: ruby -*-
# vi: set ft=ruby :

BOX="centos/stream9"
# BOX_VERSION="2011.0"
BOX_URL="https://cloud.centos.org/centos/9-stream/x86_64/images/CentOS-Stream-Vagrant-9-20250113.0.x86_64.vagrant-virtualbox.box"


# BOX="debian/jessie64"
# BOX_VERSION="8.11.1"
# BOX_URL="https://portal.cloud.hashicorp.com/vagrant/discover/debian/jessie64/versions/8.11.1"

VM_MASTER_NAME="rsafS"
VM_WORKER_NAME="rsafSW"
MASTER_IP="192.168.56.110"

CPU=1
MEM=512

HOST_SRC_PATH=
VM_SRC_PATH=

Vagrant.configure("2") do |config|

  config.vm.box = BOX
  # # config.vm.box_version = BOX_VERSION
  config.vm.box_url= BOX_URL
  
  config.vm.define VM_MASTER_NAME do |control|
    control.vm.provision "shell", privileged: true, path: "scripts/master.sh", args: [MASTER_IP]
    control.vm.network "private_network", ip:  MASTER_IP
    control.vm.hostname = VM_MASTER_NAME
    control.vm.provider "virtualbox" do |vb|
      vb.memory=MEM
      vb.cpus=CPU
      vb.name=VM_MASTER_NAME
    end
  end

  config.vm.define VM_WORKER_NAME do |control|
    control.vm.network "public_network", ip: "192.168.56.111"
    control.vm.hostname = VM_WORKER_NAME
    control.vm.provider "virtualbox" do |vb|
      vb.memory=MEM
      vb.cpus=CPU
      vb.name=VM_WORKER_NAME
    end
  end
end


# en0: Ethernet <- the name of network interface


##### this public network for the host one
# vagrant@rsafs:~$ ifconfig eth1
# eth1      Link encap:Ethernet  HWaddr 08:00:27:85:7e:c9  
#           inet addr:192.168.56.110  Bcast:192.168.56.255  Mask:255.255.255.0
#           inet6 addr: fe80::a00:27ff:fe85:7ec9/64 Scope:Link
#           UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
#           RX packets:546 errors:0 dropped:0 overruns:0 frame:0
#           TX packets:8 errors:0 dropped:0 overruns:0 carrier:0
#           collisions:0 txqueuelen:1000 
#           RX bytes:79038 (79.0 KB)  TX bytes:648 (648.0 B)



##### this private network for the host one
# vagrant@rsafs:~$ ifconfig eth1
# eth1      Link encap:Ethernet  HWaddr 08:00:27:bf:f0:93  
#           inet addr:192.168.56.110  Bcast:192.168.56.255  Mask:255.255.255.0
#           inet6 addr: fe80::a00:27ff:febf:f093/64 Scope:Link
#           UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
#           RX packets:0 errors:0 dropped:0 overruns:0 frame:0
#           TX packets:8 errors:0 dropped:0 overruns:0 carrier:0
#           collisions:0 txqueuelen:1000 
#           RX bytes:0 (0.0 B)  TX bytes:648 (648.0 B)